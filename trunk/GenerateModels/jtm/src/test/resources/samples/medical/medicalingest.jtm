{
  "header": {
    "namespace": "com.ligadata.models.samples.finance",
    "version": "0.0.1",
    "language" : "scala",
    "minVersion" : "2.11",
    "description": "Finance load transaction message",
    "name": "TransactionIngest"
  },
  "imports": {
    "packages": [ "com.ligadata.runtime.Conversion"]
  },
  "aliases": {
    "messages": {
      "m1": "com.ligadata.kamanja.samples.messages.TransactionMsgIn",
      "o1": "com.ligadata.kamanja.samples.messages.Beneficiary",
      "o2": "com.ligadata.kamanja.samples.messages.HL7",
      "o3": "com.ligadata.kamanja.samples.messages.InpatientClaim",
      "o4": "com.ligadata.kamanja.samples.messages.OutpatientClaim"
    }
  },
  "transformations": {
    "transactionmsg": {
      "dependsOn": [ ["m1"] ],
      "computes": {
        "arraydata":{ "type": "Array[String]", "val": "$data.split(\",\")", "comment": "Split the incoming data" },
        "typeName": { "type": "String", "val": "$arraydata(0)", "comment": "extract the type" }
      },
      "outputs": {
        "o1": {
          "where": "\"com.ligadata.kamanja.samples.messages.Beneficiary\" == $typeName",
          "mapping": {
            "desynpuf_id": "$arraydata(1)",
            "bene_birth_dt": "$arraydata(2)",
            "bene_death_dt": "$arraydata(3)",
            "bene_sex_ident_cd": "$arraydata(4)",
            "bene_race_cd": "$arraydata(5)",
            "bene_esrd_ind": "$arraydata(6)",
            "sp_state_code": "$arraydata(7)",
            "bene_county_cd": "$arraydata(8)",
            "bene_hi_cvrage_tot_mons": "$arraydata(9)",
            "bene_smi_cvrage_tot_mons": "$arraydata(10)",
            "bene_hmo_cvrage_tot_mons": "$arraydata(11)",
            "plan_cvrg_mos_num": "$arraydata(12)",
            "sp_alzhdmta": "$arraydata(13)",
            "sp_chf": "$arraydata(14)",
            "sp_chrnkidn": "$arraydata(15)",
            "sp_cncr": "$arraydata(16)",
            "sp_copd": "$arraydata(17)",
            "sp_depressn": "$arraydata(18)",
            "sp_diabetes": "$arraydata(19)",
            "sp_ischmcht": "$arraydata(20)",
            "sp_osteoprs": "$arraydata(21)",
            "sp_ra_oa": "$arraydata(22)",
            "sp_strketia": "$arraydata(23)",
            "medreimb_ip": "$arraydata(24)",
            "benres_ip": "$arraydata(25)",
            "pppymt_ip": "$arraydata(26)",
            "medreimb_op": "$arraydata(27)",
            "benres_op": "$arraydata(28)",
            "pppymt_op": "$arraydata(29)",
            "medreimb_car": "$arraydata(30)",
            "benres_car": "$arraydata(31)",
            "pppymt_car": "$arraydata(32)"
          }
        },
        "o2": {
          "where": "\"com.ligadata.kamanja.samples.messages.HL7\" == $typeName",
          "mapping": {
            "desynpuf_id": "$arraydata(1)",
            "clm_id": "$arraydata(2)",
            "clm_from_dt": "$arraydata(3)",
            "clm_thru_dt": "$arraydata(4)",
            "bene_birth_dt": "$arraydata(5)",
            "bene_death_dt": "$arraydata(6)",
            "bene_sex_ident_cd": "$arraydata(7)",
            "bene_race_cd": "$arraydata(8)",
            "bene_esrd_ind": "$arraydata(9)",
            "sp_state_code": "$arraydata(10)",
            "bene_county_cd": "$arraydata(11)",
            "bene_hi_cvrage_tot_mons": "$arraydata(12)",
            "bene_smi_cvrage_tot_mons": "$arraydata(13)",
            "bene_hmo_cvrage_tot_mons": "$arraydata(14)",
            "plan_cvrg_mos_num": "$arraydata(15)",
            "sp_alzhdmta": "$arraydata(16)",
            "sp_chf": "$arraydata(17)",
            "sp_chrnkidn": "$arraydata(18)",
            "sp_cncr": "$arraydata(19)",
            "sp_copd": "$arraydata(20)",
            "sp_depressn": "$arraydata(21)",
            "sp_diabetes": "$arraydata(22)",
            "sp_ischmcht": "$arraydata(23)",
            "sp_osteoprs": "$arraydata(24)",
            "sp_ra_oa": "$arraydata(25)",
            "sp_strketia": "$arraydata(26)",
            "age": "$arraydata(27)",
            "infectious_parasitic_diseases": "$arraydata(28)",
            "neoplasms": "$arraydata(29)",
            "endocrine_nutritional_metabolic_diseases_immunity_disorders": "$arraydata(30)",
            "diseases_blood_blood_forming_organs": "$arraydata(31)",
            "mental_disorders": "$arraydata(32)",
            "diseases_nervous_system_sense_organs": "$arraydata(33)",
            "diseases_circulatory_system": "$arraydata(34)",
            "diseases_respiratory_system": "$arraydata(35)",
            "diseases_digestive_system": "$arraydata(36)",
            "diseases_genitourinary_system": "$arraydata(37)",
            "complications_of_pregnancy_childbirth_the_puerperium": "$arraydata(38)",
            "diseases_skin_subcutaneous_tissue": "$arraydata(39)",
            "diseases_musculoskeletal_system_connective_tissue": "$arraydata(40)",
            "congenital_anomalies": "$arraydata(41)",
            "certain_conditions_originating_in_the_perinatal_period": "$arraydata(42)",
            "symptoms_signs_ill_defined_conditions": "$arraydata(43)",
            "injury_poisoning": "$arraydata(44)",
            "factors_influencing_health_status_contact_with_health_services": "$arraydata(45)",
            "external_causes_of_injury_poisoning": "$arraydata(46)",
            "hypothyroidism": "$arraydata(47)",
            "infarction": "$arraydata(48)",
            "alzheimer": "$arraydata(49)",
            "alzheimer_related": "$arraydata(50)",
            "anemia": "$arraydata(51)",
            "asthma": "$arraydata(52)",
            "atrial_fibrillation": "$arraydata(53)",
            "hyperplasia": "$arraydata(54)",
            "cataract": "$arraydata(55)",
            "kidney_disease": "$arraydata(56)",
            "pulmonary_disease": "$arraydata(57)",
            "depression": "$arraydata(58)",
            "diabetes": "$arraydata(59)",
            "glaucoma": "$arraydata(60)",
            "heart_failure": "$arraydata(61)",
            "hip_pelvic_fracture": "$arraydata(62)",
            "hyperlipidemia": "$arraydata(63)",
            "hypertension": "$arraydata(64)",
            "ischemic_heart_disease": "$arraydata(65)",
            "osteoporosis": "$arraydata(66)",
            "ra_oa": "$arraydata(67)",
            "stroke": "$arraydata(68)",
            "breast_cancer": "$arraydata(69)",
            "colorectal_cancer": "$arraydata(70)",
            "prostate_cancer": "$arraydata(71)",
            "lung_cancer": "$arraydata(72)",
            "endometrial_cancer": "$arraydata(73)",
            "tobacco": "$arraydata(74)",
            "height": "$arraydata(75)",
            "weight": "$arraydata(76)",
            "systolic": "$arraydata(77)",
            "diastolic": "$arraydata(78)",
            "totalcholesterol": "$arraydata(79)",
            "ldl": "$arraydata(80)",
            "triglycerides": "$arraydata(81)",
            "shortnessofbreath": "$arraydata(82)",
            "chestpain": "$arraydata(83)",
            "aatdeficiency": "$arraydata(84)",
            "chroniccough": "$arraydata(85)",
            "chronicsputum": "$arraydata(86)"
          }
        },
        "o3": {
          "where": "\"com.ligadata.kamanja.samples.messages.inpatientclaim\" == $typename",
          "mapping": {
            "desynpuf_id": "$arraydata(1)",
            "clm_id": "$arraydata(2)",
            "segment": "$arraydata(3)",
            "clm_from_dt": "$arraydata(4)",
            "clm_thru_dt": "$arraydata(5)",
            "prvdr_num": "$arraydata(6)",
            "clm_pmt_amt": "$arraydata(7)",
            "nch_prmry_pyr_clm_pd_amt": "$arraydata(8)",
            "at_physn_npi": "$arraydata(9)",
            "op_physn_npi": "$arraydata(10)",
            "ot_physn_npi": "$arraydata(11)",
            "clm_admsn_dt": "$arraydata(12)",
            "admtng_icd9_dgns_cd": "$arraydata(13)",
            "clm_pass_thru_per_diem_amt": "$arraydata(14)",
            "nch_bene_ip_ddctbl_amt": "$arraydata(15)",
            "nch_bene_pta_coinsrnc_lblty_am": "$arraydata(16)",
            "nch_bene_blood_ddctbl_lblty_am": "$arraydata(17)",
            "clm_utlztn_day_cnt": "$arraydata(18)",
            "nch_bene_dschrg_dt": "$arraydata(19)",
            "clm_drg_cd": "$arraydata(20)",
            "icd9_dgns_cds": "$arraydata(21)",
            "icd9_prcdr_cds": "$arraydata(22)",
            "hcpcs_cds": "$arraydata(23)"
          }
        },
        "o4": {
          "where": "\"com.ligadata.kamanja.samples.messages.OutpatientClaim\" == $typeName",
          "mapping": {
            "desynpuf_id": "$arraydata(1)",
            "clm_id": "$arraydata(2)",
            "segment": "$arraydata(3)",
            "clm_from_dt": "$arraydata(4)",
            "clm_thru_dt": "$arraydata(5)",
            "prvdr_num": "$arraydata(6)",
            "clm_pmt_amt": "$arraydata(7)",
            "nch_prmry_pyr_clm_pd_amt": "$arraydata(8)",
            "at_physn_npi": "$arraydata(9)",
            "op_physn_npi": "$arraydata(10)",
            "ot_physn_npi": "$arraydata(11)",
            "nch_bene_blood_ddctbl_lblty_am": "$arraydata(12)",
            "icd9_dgns_cds": "$arraydata(13)",
            "icd9_prcdr_cds": "$arraydata(14)",
            "nch_bene_ptb_ddctbl_amt": "$arraydata(15)",
            "nch_bene_ptb_coinsrnc_amt": "$arraydata(16)",
            "admtng_icd9_dgns_cd": "$arraydata(17)",
            "hcpcs_cds": "$arraydata(18)"
          }
        }
      }
    }
  }
}
